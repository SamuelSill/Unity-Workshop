<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style1.css">
    <title>Draw&Drive-Login</title>
</head>
<body>
   <div class="con">
    <!-- form with 2 inputs, username,password  and a submit button -->
        <h1 class="menuHeader"></h1>
    <div class="formCon" >
        <input class="FormInput"  type="text" id="username" name="username" placeholder="username" required>
        <input class="FormInput" type="password" id="password" name="password" placeholder="password" required>
        <button class="FormBtn" >
            Log in
            </button>
    </div>
   </div> 
   <script>
    const username = document.getElementById('username');
    const password = document.getElementById('password');

    const btn = document.querySelector('.FormBtn');

    // class RegistrationForm{
    //     username: str
    //     password: str
    //     first_name: str
    //     last_name: str
    //     description: Optional[str]
    // }

    class RegistrationForm {
        constructor(username, password, first_name, last_name, description) {
            this.username = username;
            this.password = password;
            this.first_name = first_name;
            this.last_name = last_name;
            this.description = description;
        }
    }


    const api_login_request = () =>{
        console.log(username.value); 
        console.log(password.value);
        const body = new RegistrationForm(username.value, password.value, 'first_name', 'last_name', 'description');
        fetch('http://localhost/players/register', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(body),
        })
        .then(response => response.json())
        .then(data => {
            console.log('Success:', data);
            // Redirect to lobby.html after successful login
            window.location.href = 'lobby.html';
        })
        .catch((error) => {
            console.error('Error:', error);
        });

    }

    btn.addEventListener('click', (e) => {
        e.preventDefault();
        if(username.value === '' && password.value === ''){
            return;
        }else{
            api_login_request();
        }
    })

   </script>
</body>
</html>